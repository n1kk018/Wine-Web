<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	template="/WEB-INF/templates/commons.xhtml">
	
	<ui:define name="body">
		<form jsf:id="form1">
			<div id="content">
				<div class="container">
					<div class="col-md-12">
						<ul class="breadcrumb">
							<li><a href="#">Accueil</a></li>
							<li>Mon panier</li>
						</ul>
					</div>
					<div class="col-md-9" id="basket">
						<div class="box">
							<h1>Mon panier</h1>
							<h:panelGroup
								rendered="#{mBeanCartManagement.order.ordersDetail.size() != 0}">
								<p class="text-muted">
									Votre panier contient
									<h:outputText id="txtTotalQuantity"
										value="#{mBeanCartManagement.calculerNumTotalQantity()}" />
									produits.
								</p>
								<h:panelGroup
									rendered="#{mBeanCartManagement.validOrder == false}">
									<div class="table-responsive">
										<table class="table">
											<thead>
												<tr>
													<th>Produit</th>
													<th>Quantite</th>
													<th>Prix Unitaire</th>
													<th>Reduction</th>
													<th colspan="2">Totale</th>
													<th></th>
												</tr>
											</thead>
											<tbody>
												<h:panelGroup id="myPanel">
													<ui:repeat id="uiRepeatCart"
														value="#{mBeanCartManagement.listOrderDetails}"
														var="orderDetail">
														<tr>
															<td><a href="pages/article.jsf"> <img
																	src="img/wine_pictures/#{orderDetail.productOrdered.apiId}/#{orderDetail.productOrdered.apiId}m.jpg"
																	alt="#{orderDetail.productOrdered.name}" />
															</a></td>
															<td><input jsf:id="quantityProduct" type="number"
																jsf:value="#{orderDetail.quantite}" class="form-control">
															<f:ajax event="change" execute="@form" render="@form" />
																</input></td>
															<td><h:outputText
																	value="#{orderDetail.productOrdered.price}€">
																</h:outputText></td>
															<td><h:outputText
																	value="#{mBeanCartManagement.calculDiscount(orderDetail)}€">
																</h:outputText></td>
															<td><h:outputText id="totalLine"
																	value="#{mBeanCartManagement.calculTotalLine(orderDetail)}€">
																</h:outputText></td>
															<td><h:commandLink
																	action="#{mBeanCartManagement.removeProductCart(orderDetail)}">
																	<i class="fa fa-trash-o"></i>
																</h:commandLink></td>
														</tr>
													</ui:repeat>
												</h:panelGroup>
											</tbody>
										</table>
									</div>
								</h:panelGroup>
								<!-- /.table-responsive -->


								<div class="box-footer">
									<div class="pull-left">
										<a href="index.jsf" class="btn btn-default"><i
											class="fa fa-chevron-left"></i> Continue shopping</a>
									</div>
									<div class="pull-right">
										<button class="btn btn-default">
											<i class="fa fa-refresh"></i> Update basket
										</button>
										<h:commandButton
											action="#{mBeanCartManagement.validePanier()}"
											value="Valider et payer ma commande" class="btn btn-primary"></h:commandButton>
									</div>
								</div>
							</h:panelGroup>

							<!-- panel empty -->
							<h:panelGroup
								rendered="#{mBeanCartManagement.order.ordersDetail.size() == 0 }">
								<h3>Votre panier est vide pour le moment. Remplissez le de
									bonnes bouteilles et de bons produits...</h3>
								<div class="box-footer">
									<div class="pull-left">
										<a href="index.jsf" class="btn btn-default"><i
											class="fa fa-chevron-left"></i> Continuer mon shopping</a>
									</div>
									<div class="pull-right">
										<button class="btn btn-default">
											<i class="fa fa-refresh"></i> Actualiser mon panier
										</button>
										<button type="submit" class="btn btn-primary">
											Valider et payer ma commande <i class="fa fa-chevron-right"></i>
										</button>
									</div>
								</div>
							</h:panelGroup>

						</div>
						<!-- /.box -->
						<!-- 						<div class="row same-height-row"> -->
						<form jsf:id="form1">
							<div id="hot">
								<div class="box">
									<div class="container">
										<div class="col-md-9">
											<h3>Vous pourriez également aimer ces produits</h3>
										</div>
									</div>
								</div>
								<div class="container">
									<div class="product-slider">
										<ui:repeat var="product"
											value="#{mBeanProduct.expensiveProducts}">
											<div class="item">
												<div class="product">
													<div class="flip-container">
														<div class="flipper">
															<div class="front">
																<a href="#{mBeanCartProduct.article(product.idProduct)}">
																	<img
																	src="img/wine_pictures/#{product.apiId}/#{product.apiId}_front.jpg"
																	alt="" class="img-responsive" />
																</a>
															</div>
															<div class="back">
																<a href="#{mBeanProduct.article(product.idProduct)}">
																	<img
																	src="img/wine_pictures/#{product.apiId}/#{product.apiId}_back.jpg"
																	alt="" class="img-responsive" />
																</a>
															</div>
														</div>
													</div>
													<a href="#{mBeanProduct.article(product.idProduct)}"
														class="invisible"> <img
														src="img/wine_pictures/#{product.apiId}/#{product.apiId}_front.jpg"
														alt="" class="img-responsive" />
													</a>
													<div class="text">
														<h3>
															<a href="#{mBeanProduct.article(product.idProduct)}">#{product.name}</a>
														</h3>
														<p class="price">#{product.price}€</p>
														<a
															jsf:action="#{mBeanCartManagement.addProductCart(product)}"
															class="btn btn-primary hotlist-btn"> <i
															class="fa fa-shopping-cart"></i><span class="hidden-sm">Ajouter
																au panier</span>
														</a>
													</div>
													<!-- /.text -->
													<div class="ribbon new">
														<div class="theribbon">HOT</div>
														<div class="ribbon-background"></div>
													</div>
												</div>
												<!-- /.product -->
											</div>
										</ui:repeat>

									</div>
								</div>
							</div>
						</form>
						<!-- 						</div> -->
					</div>
					<!-- /.col-md-9 -->

					<div class="col-md-3">
						<h:panelGroup
							rendered="#{mBeanCartManagement.order.ordersDetail != null}">
							<div class="box" id="order-summary">
								<div class="box-header">
									<h3>Recapitulatif du panier</h3>
								</div>
								<p class="text-muted">Les Couts du transport et couts
									additionnel sont calculees a partir des valeurs que vous avez
									rentrees.</p>
								<div class="table-responsive">
									<table class="table" id="tabRecapOrder">
										<tbody>
											<tr>
												<td>Sous total</td>
												<th><h:outputText id="subTotal"
														value="#{mBeanCartManagement.calculSubTotal()}€">
													</h:outputText></th>
											</tr>
											<tr>
												<td>Frais de transport</td>
												<th><h:outputText id="shipping"
														value="#{mBeanCartManagement.caclulShippingFree()}€">
													</h:outputText></th>
											</tr>
											<tr>
												<td>Tax</td>
												<th>0.00€</th>
											</tr>
											<tr class="total">
												<td>Total</td>
												<th><h:outputText id="total"
														value="#{mBeanCartManagement.calculTotal()}€">
													</h:outputText></th>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</h:panelGroup>
						<h:panelGroup
							rendered="#{mBeanCartManagement.order.ordersDetail == null}">
							<div class="box" id="order-summary">
								<div class="box-header">
									<h3>Order summary</h3>
								</div>
								<p class="text-muted">Les Couts du transport et couts
									additionnel sont calculees a partir des valeurs que vous avez
									rentrees.</p>
								<div class="table-responsive">
									<table class="table" id="tabRecapOrder">
										<tbody>
											<tr>
												<td>prix articles</td>
												<th>0.00€</th>
											</tr>
											<tr>
												<td>Frais de transport</td>
												<th>0.00€</th>
											</tr>
											<tr>
												<td>Tax</td>
												<th>0.00€</th>
											</tr>
											<tr class="total">
												<td>Total</td>
												<th>0.00€</th>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</h:panelGroup>
					</div>
				</div>
				<!-- /.col-md-3 -->
			</div>
			<!-- /.container -->
		</form>
	</ui:define>
</ui:composition>

